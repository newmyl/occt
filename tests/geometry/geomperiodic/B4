bsplinecurve c1 4 3 0 5 3.1415926535897931 3 6.2831853071795862 5 0 20 100 1 -14.1421356237309 20 106.594586144012 1 -34.9044110322929 0 116.276194167748 1 -14.1421356237311 -20 106.594586144013 1 14.142135623731 -20 93.4054138559873 1 34.904411032293 0 83.7238058322526 1 14.1421356237309 20 93.4054138559873 1 0 20 100 1 

if { [regexp {is not periodic} [curveperiod c1] ] } {
  puts "OK. The curve is not periodic"
} else {
  puts "Error: the not periodic curve is detected to be periodic"
}

setperiodic c1
point pp 1 1 1
offsetcurve co c1 -1 pp

if { ![regexp {is periodic} [curveperiod co] ] } {
  puts "Error: the periodic curve is detected to be not periodic"
} else {
  puts "OK. The curve is true periodic"
}

trim c2 co 2 5

if { ![regexp {is periodic} [curveperiod c2] ] } {
  puts "Error: the periodic curve is detected to be not periodic"
} else {
  puts "OK. The curve is true periodic"
}

revsurf s1 co -0.654999286110526 48.1473822524761 100.305431183199 0.906307787036651 0 -0.422618261740697 
revsurf s2 c2 -0.654999286110526 48.1473822524761 100.305431183199 0.906307787036651 0 -0.422618261740697 

trim st1 s1 pi 2*pi 3 4
trim st2 s2 pi 2*pi 3 4

# The surfaces st1 and st2 take the same locus.

set logS1 [surfaceperiod s1]
set logS2 [surfaceperiod s2]
set logST1 [surfaceperiod st1]
set logST2 [surfaceperiod st2]

# s1 is a surface of revolution based on the offset curve.
# Currently, offset from B-spline curve is always detected as not-closed.
# Therefore, s1 is U-periodic and is not V-periodic.

if { ![regexp {is U-periodic} $logS1 ] } {
  puts "Error: the U-periodic surface is detected to be not periodic"
} else {
  puts "OK. The surface is true U-periodic"
}

if { ![regexp {is not V-periodic} $logS1 ] } {
  puts "Error: the V-periodic surface is detected to be not periodic"
} else {
  puts "OK. The surface is true V-periodic"
}

# s2 is a surface of revolution based on not closed curve.
# Therefore, it is U-periodic and is not V-periodic.
if { ![regexp {is U-periodic} $logS2 ] } {
  puts "Error: the U-periodic surface is detected to be not periodic"
} else {
  puts "OK. The surface is true U-periodic"
}

if { [regexp {is not V-periodic} $logS2 ] } {
  puts "OK. The surface is not V-periodic"
} else {
  puts "Error: the not V-periodic surface is detected to be V-periodic"
}

# Trim operation does not affect the periodicity

if { ![regexp {is U-periodic} $logST1 ] } {
  puts "Error: the U-periodic surface is detected to be not periodic"
} else {
  puts "OK. The surface is true U-periodic"
}

if { ![regexp {is not V-periodic} $logST1 ] } {
  puts "Error: the V-periodic surface is detected to be not periodic"
} else {
  puts "OK. The surface is true V-periodic"
}

if { ![regexp {is U-periodic} $logST2 ] } {
  puts "Error: the U-periodic surface is detected to be not periodic"
} else {
  puts "OK. The surface is true U-periodic"
}

if { [regexp {is not V-periodic} $logST2 ] } {
  puts "OK. The surface is not V-periodic"
} else {
  puts "Error: the not V-periodic surface is detected to be V-periodic"
}
